'use strcit'

let roles = new Array("Антон Антонович Сквозник-Дмухановский, городничий.",
                       "Анна Андреевна, жена его.",
                       "Марья Антоновна, дочь его",
                       "Лука Лукич Хлопов, смотритель училищ.",
                       "Аммос Федорович Ляпкин-Тяпкин, судья.",
                       "Артемий Филиппович Земляника, попечитель богоугодных заведений.")
let text = "Городничий: Я пригласил вас, господа, с тем чтобы сообщить вам пренеприятное известие: к нам едет ревизор.Аммос Федорович: Как ревизор?Артемий Филиппович: Как ревизор?Городничий: Ревизор из Петербурга, инкогнито. И еще с секретным предписаньем.Аммос Федорович: Вот те на!Артемий Филиппович: Вот не было заботы, так подай!Лука Лукич: Господи Боже! еще и с секретным предписаньем!Городничий: Я как будто предчувствовал: сегодня мне всю ночь снились какие-то две необыкновенные крысы. Право, этаких я никогда не видывал: черные, неестественной величины! пришли, понюхали — и пошли прочь. Вот я вам прочту письмо, которое получил я от Андрея Ивановича Чмыхова, которого вы, Артемий Филиппович, знаете. Вот что он пишет: «Любезный друг, кум и благодетель (бормочет вполголоса, пробегая скоро глазами)... и уведомить тебя». А! вот: «Спешу, между прочим, уведомить тебя, что приехал чиновник с предписанием осмотреть всю губернию и особенно наш уезд (значительно поднимает палец вверх). Я узнал это от самых достоверных людей, хотя он представляет себя частным лицом. Так как я знаю, что за тобою, как за всяким, водятся грешки, потому что ты человек умный и не любишь пропускать того, что плывет в руки...» (остановясь), ну, здесь свои... «то советую тебе взять предосторожность, ибо он может приехать во всякий час, если только уже не приехал и не живет где-нибудь инкогнито... Вчерашнего дни я...» Ну, тут уж пошли дела семейные: «...сестра Анна Кириловна приехала к нам с своим мужем; Иван Кирилович очень потолстел и все играет на скрыпке...» — и прочее, и прочее. Так вот какое обстоятельство!Аммос Федорович: Да, обстоятельство такое... необыкновенно, просто необыкновенно. Что-нибудь недаром.Лука Лукич: Зачем же, Антон Антонович, отчего это? Зачем к нам ревизор?Городничий: Зачем! Так уж, видно, судьба! (Вздохнув.) До сих пор, благодарение Богу, подбирались к другим городам; теперь пришла очередь к нашему.Аммос Федорович: Я думаю, Антон Антонович, что здесь тонкая и больше политическая причина. Это значит вот что: Россия... да... хочет вести войну, и министерия-то, вот видите, и подослала чиновника, чтобы узнать, нет ли где измены.Городничий: Эк куда хватили! Еще умный человек! В уездном городе измена! Что он, пограничный, что ли? Да отсюда, хоть три года скачи, ни до какого государства не доедешь.Аммос Федорович: Нет, я вам скажу, вы не того... вы не... Начальство имеет тонкие виды: даром что далеко, а оно себе мотает на ус.Городничий: Мотает или не мотает, а я вас, господа, предуведомил. Смотрите, по своей части я кое-какие распоряженья сделал, советую и вам. Особенно вам, Артемий Филиппович! Без сомнения, проезжающий чиновник захочет прежде всего осмотреть подведомственные вам богоугодные заведения — и потому вы сделайте так, чтобы все было прилично: колпаки были бы чистые, и больные не походили бы на кузнецов, как обыкновенно они ходят по-домашнему.Артемий Филиппович: Ну, это еще ничего. Колпаки, пожалуй, можно надеть и чистые.Городничий: Да, и тоже над каждой кроватью надписать по-латыни или на другом каком языке... это уж по вашей части, Христиан Иванович, — всякую болезнь: когда кто заболел, которого дня и числа... Нехорошо, что у вас больные такой крепкий табак курят, что всегда расчихаешься, когда войдешь. Да и лучше, если б их было меньше: тотчас отнесут к дурному смотрению или к неискусству врача.Артемий Филиппович: О! насчет врачеванья мы с Христианом Ивановичем взяли свои меры: чем ближе к натуре, тем лучше, — лекарств дорогих мы не употребляем. Человек простой: если умрет, то и так умрет; если выздоровеет, то и так выздоровеет. Да и Христиану Ивановичу затруднительно было б с ними изъясняться: он по-русски ни слова не знает.Христиан Иванович издает звук, отчасти похожий на букву и и несколько на е.Городничий: Вам тоже посоветовал бы, Аммос Федорович, обратить внимание на присутственные места. У вас там в передней, куда обыкновенно являются просители, сторожа завели домашних гусей с маленькими гусенками, которые так и шныряют под ногами. Оно, конечно, домашним хозяйством заводиться всякому похвально, и почему ж сторожу и не завесть его? только, знаете, в таком месте неприлично... Я и прежде хотел вам это заметить, но все как-то позабывал.Аммос Федорович: А вот я их сегодня же велю всех забрать на кухню. Хотите, приходите обедать.Городничий: Кроме того, дурно, что у вас высушивается в самом присутствии всякая дрянь и над самым шкапом с бумагами охотничий арапник. Я знаю, вы любите охоту, но все на время лучше его принять, а там, как проедет ревизор, пожалуй, опять его можете повесить. Также заседатель ваш... он, конечно, человек сведущий, но от него такой запах, как будто бы он сейчас вышел из винокуренного завода, — это тоже нехорошо. Я хотел давно об этом сказать вам, но был, не помню, чем-то развлечен. Есть против этого средства, если уже это действительно, как он говорит, у него природный запах: можно ему посоветовать есть лук, или чеснок, или что-нибудь другое. В этом случае может помочь разными медикаментами Христиан Иванович.";
  
function divedeOnRoles(text, roles) {
    let rolesWithoutRepeat = new Array();
    let textPhrases = new Array();
    let totalLength = 0;
    textPhrases = text.split(/[\.|\?|\!|\.{3}](?=[А-Я])/);
    for(let i = 0; i < textPhrases.length; i++) {
        totalLength += textPhrases[i].length;
        textPhrases[i] += text.charAt(totalLength + i);
    }
    for(let i = 0; i < textPhrases.length; i++) {
        let string = textPhrases[i].split(/(?<=^[A-Я][A-яа-я\s]+)\:\s/);
        if(!rolesWithoutRepeat.includes(string[0]) && string.length > 1)
            rolesWithoutRepeat.push(string[0]);
    }
    for(let i = 0; i < rolesWithoutRepeat.length; i++)
    {
        let role = document.createElement("p")
        role.innerText = rolesWithoutRepeat[i] + ":";
        for(let j = 0; j < textPhrases.length; j++) {
            let string = textPhrases[j].split(/(?<=^[A-Я][A-яа-я\s]+)\:\s/);
            let phrase = document.createElement("p");
            if(string[0] === rolesWithoutRepeat[i]) {
                phrase.innerText = (j + 1) + ") " + string[1];
            }
            else if(string.length === 1) {
                phrase.innerText = string;
            }
            role.appendChild(phrase);
        }
        document.body.appendChild(role);
    }
}
divedeOnRoles(text, roles);